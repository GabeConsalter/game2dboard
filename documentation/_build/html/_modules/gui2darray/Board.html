
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>game2dboard.Board &#8212; game2dboard  documentation</title>
    <link rel="stylesheet" href="../../_static/graphite.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="../../index.html">game2dboard  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for game2dboard.Board</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">tkinter</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">game2dboard</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">UserList</span>

<span class="c1"># TODO:</span>
<span class="c1">#       rezize(r, c), self[i] = [...], beep(), play_sound(), ...</span>


<div class="viewcode-block" id="Board"><a class="viewcode-back" href="../../Board.html#game2dboard.Board">[docs]</a><span class="k">class</span> <span class="nc">Board</span><span class="p">(</span><span class="n">UserList</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A graphic user interface for a 2d array (matrix)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">nrows</span><span class="p">,</span>
            <span class="n">ncols</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Creates an App</span>

<span class="sd">        :param int nrows:</span>
<span class="sd">            The number of rows.</span>

<span class="sd">        :param int ncols:</span>
<span class="sd">            The number of columns.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">UserList</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>             <span class="c1"># Initialize parent class</span>
        <span class="c1"># Create list [ncols][nrows]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_BoardRow</span><span class="p">(</span><span class="n">ncols</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span> <span class="o">=</span> <span class="n">nrows</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ncols</span> <span class="o">=</span> <span class="n">ncols</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_isrunning</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># Array used to store cells elements (rectangles)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cells</span> <span class="o">=</span> <span class="p">[[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">ncols</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_title</span> <span class="o">=</span> <span class="s2">&quot;game2dboard&quot;</span>            <span class="c1"># Default window title</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cursor</span> <span class="o">=</span> <span class="s2">&quot;hand1&quot;</span>                <span class="c1"># Default mouse cursor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_margin</span> <span class="o">=</span> <span class="mi">5</span>                      <span class="c1"># board margin (px)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cell_spacing</span> <span class="o">=</span> <span class="mi">1</span>                <span class="c1"># grid cell_spacing (px)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_margin_color</span> <span class="o">=</span> <span class="s2">&quot;light grey&quot;</span>     <span class="c1"># default border color</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cell_color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span>            <span class="c1"># default cell color</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_grid_color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span>            <span class="c1"># default grid color</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_root</span> <span class="o">=</span> <span class="n">Tk</span><span class="p">()</span>
        <span class="c1"># cell&#39;s container</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_canvas</span> <span class="o">=</span> <span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="c1"># event bindings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_key_press</span> <span class="o">=</span> <span class="kc">None</span>           <span class="c1"># user key press callback</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_mouse_click</span> <span class="o">=</span> <span class="kc">None</span>         <span class="c1"># user mouse callback</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timer_interval</span> <span class="o">=</span> <span class="mi">0</span>            <span class="c1"># ms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_timer</span> <span class="o">=</span> <span class="kc">None</span>               <span class="c1"># user timer callback</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_after_id</span> <span class="o">=</span> <span class="kc">None</span>               <span class="c1"># current timer id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_in_timer_calback</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># register internal key callback</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Key&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_key_press_clbk</span><span class="p">)</span>
        <span class="c1"># register internal mouse callback</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonPress&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mouse_click_clbk</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_msgbar</span> <span class="o">=</span> <span class="kc">None</span>                 <span class="c1"># message bar component</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>             <span class="c1"># subscript getter: self[row]</span>
        <span class="c1"># Store last accessed row (NOT thread safe... )</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_BoardRow</span><span class="o">.</span><span class="n">current_i</span> <span class="o">=</span> <span class="n">row</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>     <span class="c1"># return a _BoardRow</span>

    <span class="c1"># Properties</span>
    <span class="c1"># ---------------------------------------------------------------</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">title</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Gets or sets the window title.</span>

<span class="sd">        :type: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_title</span>

    <span class="nd">@title</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_title</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cursor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Gets or sets the mouse cursor shape.</span>

<span class="sd">        :type: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cursor</span>

    <span class="nd">@cursor</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">cursor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cursor</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_canvas</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">cursor</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">margin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Gets or sets the board margin (px).</span>

<span class="sd">        :type: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_margin</span>

    <span class="nd">@margin</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">margin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isrunning</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Can&#39;t update margin after show()&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_margin</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">padx</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cell_spacing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets or sets the space between cells (px).</span>

<span class="sd">        :type: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cell_spacing</span>

    <span class="nd">@cell_spacing</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">cell_spacing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isrunning</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Can&#39;t update cell_spacing after show()&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cell_spacing</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_resize</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">margin_color</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets or sets the margin_color.</span>

<span class="sd">        :type: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_margin_color</span>

    <span class="nd">@margin_color</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">margin_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_margin_color</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cell_color</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets or sets cells color</span>

<span class="sd">        :type: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cell_color</span>

    <span class="nd">@cell_color</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">cell_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cell_color</span> <span class="o">=</span> <span class="n">value</span>
        <span class="c1"># Update bgcolor for all cells</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isrunning</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cells</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">bg</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">grid_color</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets or sets grid color</span>

<span class="sd">        :type: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid_color</span>

    <span class="nd">@grid_color</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">grid_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_grid_color</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_canvas</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cell_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets or sets the cells dimension (width, height)</span>

<span class="sd">        :type: int or (int, int)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">game2dboard</span><span class="o">.</span><span class="n">Cell</span><span class="o">.</span><span class="n">size</span>

    <span class="nd">@cell_size</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">cell_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isrunning</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Can&#39;t resize cells after run()&quot;</span><span class="p">)</span>
        <span class="c1"># size is a tuple (width, height)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="n">game2dboard</span><span class="o">.</span><span class="n">Cell</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">value</span>    <span class="c1"># All cells has same size (class field)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_resize</span><span class="p">()</span>

    <span class="c1"># Events</span>
    <span class="c1"># ---------------------------------------------------------------</span>

    <span class="c1"># Keyboard events</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">on_key_press</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets or sets the keyboard callback function</span>

<span class="sd">        :type: function(key: str)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_key_press</span>

    <span class="nd">@on_key_press</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">on_key_press</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_key_press</span> <span class="o">=</span> <span class="n">value</span>

    <span class="c1"># Internal callback</span>
    <span class="k">def</span> <span class="nf">_key_press_clbk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ev</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_key_press</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_on_key_press</span><span class="p">(</span><span class="n">ev</span><span class="o">.</span><span class="n">keysym</span><span class="p">)</span>

    <span class="c1"># Mouse click events</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">on_mouse_click</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets or sets the mouse callback function</span>

<span class="sd">        :type: function(button: str)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_mouse_click</span>

    <span class="nd">@on_mouse_click</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">on_mouse_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_mouse_click</span> <span class="o">=</span> <span class="n">value</span>

    <span class="c1"># Internal callback</span>
    <span class="k">def</span> <span class="nf">_mouse_click_clbk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ev</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_mouse_click</span><span class="p">):</span>
            <span class="n">rc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xy2rc</span><span class="p">(</span><span class="n">ev</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">ev</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">rc</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_on_mouse_click</span><span class="p">(</span><span class="n">ev</span><span class="o">.</span><span class="n">num</span><span class="p">,</span> <span class="n">rc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rc</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># Timer events</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">on_timer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets or sets the timer callback function</span>

<span class="sd">        :type: function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_timer</span>

    <span class="nd">@on_timer</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">on_timer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_timer</span> <span class="o">=</span> <span class="n">value</span>

    <span class="c1"># internal callback</span>
    <span class="k">def</span> <span class="nf">_timer_clbk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timer_interval</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">callable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_timer</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_is_in_timer_calback</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_on_timer</span><span class="p">()</span>              <span class="c1"># Call the user callback function</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_is_in_timer_calback</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timer_interval</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>      <span class="c1"># User callback function may change timer!</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_after_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">.</span><span class="n">after</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_timer_interval</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timer_clbk</span><span class="p">)</span>

    <span class="c1"># Methods</span>
    <span class="c1"># ---------------------------------------------------------------</span>

<div class="viewcode-block" id="Board.show"><a class="viewcode-back" href="../../Board.html#game2dboard.Board.show">[docs]</a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Create the GUI, display and enter the run loop.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setupUI</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_isrunning</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span></div>

<div class="viewcode-block" id="Board.start_timer"><a class="viewcode-back" href="../../Board.html#game2dboard.Board.start_timer">[docs]</a>    <span class="k">def</span> <span class="nf">start_timer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msecs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Start a periodic timer that executes the a function every msecs milliseconds</span>

<span class="sd">        The callback function must be registered using .on_timer property.</span>

<span class="sd">        :param int msecs: Time in milliseconds.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">msecs</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timer_interval</span><span class="p">:</span>                       <span class="c1"># changed</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop_timer</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_timer_interval</span> <span class="o">=</span> <span class="n">msecs</span>
            <span class="k">if</span> <span class="n">msecs</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_in_timer_calback</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_after_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="n">msecs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timer_clbk</span><span class="p">)</span></div>

<div class="viewcode-block" id="Board.stop_timer"><a class="viewcode-back" href="../../Board.html#game2dboard.Board.stop_timer">[docs]</a>    <span class="k">def</span> <span class="nf">stop_timer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Stops the current timer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timer_interval</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_after_id</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">.</span><span class="n">after_cancel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_after_id</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_after_id</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Board.pause"><a class="viewcode-back" href="../../Board.html#game2dboard.Board.pause">[docs]</a>    <span class="k">def</span> <span class="nf">pause</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msecs</span><span class="p">,</span> <span class="n">change_cursor</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Delay the program execution for a given number of milliseconds.  </span>
<span class="sd">        </span>
<span class="sd">        Warning: long pause freezes the GUI!</span>

<span class="sd">        :param int msecs: Time in milliseconds.</span>
<span class="sd">        :param bool change_cursor: Change the cursor to &quot;watch&quot; during pause?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">change_cursor</span><span class="p">:</span>
            <span class="n">oldc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span> <span class="o">=</span> <span class="s2">&quot;watch&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">.</span><span class="n">update_idletasks</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="n">msecs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">change_cursor</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span> <span class="o">=</span> <span class="n">oldc</span></div>

<div class="viewcode-block" id="Board.shuffle"><a class="viewcode-back" href="../../Board.html#game2dboard.Board.shuffle">[docs]</a>    <span class="k">def</span> <span class="nf">shuffle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Random shuffle all values in the board</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Copy all values to an array, random.shuffle it, then copy back</span>
        <span class="n">a</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">a</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ncols</span><span class="p">):</span>
                <span class="n">row</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span></div>

<div class="viewcode-block" id="Board.fill"><a class="viewcode-back" href="../../Board.html#game2dboard.Board.fill">[docs]</a>    <span class="k">def</span> <span class="nf">fill</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Fill the board (or a row, or a column) whith a value</span>

<span class="sd">        :param value: The value to store</span>
<span class="sd">        :param int row: Index of row to fill. Default=None (all rows)</span>
<span class="sd">        :param int col: Index of column to fill. Default=None (all columns)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">row</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>         <span class="c1"># all rows and columns</span>
            <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ncols</span><span class="p">):</span>
                    <span class="bp">self</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">row</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># single row</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ncols</span><span class="p">):</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">elif</span> <span class="n">row</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>   <span class="c1"># a single collumn</span>
            <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span><span class="p">):</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Invalid argument supplied (row= AND col=)&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Board.clear"><a class="viewcode-back" href="../../Board.html#game2dboard.Board.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Clear the board, setting all values to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span></div>

<div class="viewcode-block" id="Board.close"><a class="viewcode-back" href="../../Board.html#game2dboard.Board.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Close the board, exiting the program.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span></div>

<div class="viewcode-block" id="Board.create_output"><a class="viewcode-back" href="../../Board.html#game2dboard.Board.create_output">[docs]</a>    <span class="k">def</span> <span class="nf">create_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_msgbar</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_msgbar</span> <span class="o">=</span> <span class="n">game2dboard</span><span class="o">.</span><span class="n">OutputBar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Board.print"><a class="viewcode-back" href="../../Board.html#game2dboard.Board.print">[docs]</a>    <span class="k">def</span> <span class="nf">print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">objects</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_msgbar</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">)</span> <span class="o">+</span> <span class="n">end</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_msgbar</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></div>

    <span class="c1"># Internal functions</span>
    <span class="c1"># ---------------------------------------------------------------</span>

    <span class="k">def</span> <span class="nf">_setupUI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">.</span><span class="n">resizable</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>            <span class="c1"># Window is not resizable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">margin_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_margin_color</span>        <span class="c1"># Paint background</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid_color</span>            <span class="c1"># Table inner lines</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cell_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cell_color</span>            <span class="c1"># Cells background</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">margin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_margin</span>                    <span class="c1"># Change root&#39;s margin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cell_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cell_spacing</span>        <span class="c1"># Change root&#39;s padx/y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_title</span>                      <span class="c1"># Update window&#39;s title</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cursor</span>
        <span class="c1"># Create all cells</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ncols</span><span class="p">):</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rc2xy</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
                <span class="n">newcell</span> <span class="o">=</span> <span class="n">game2dboard</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_canvas</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
                <span class="n">newcell</span><span class="o">.</span><span class="n">bgcolor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cell_color</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_cells</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">newcell</span>
                <span class="k">if</span> <span class="bp">self</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>                      <span class="c1"># Cell already has a value</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_notify_change</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">])</span>    <span class="c1"># show it</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_canvas</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_notify_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">new_value</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cells</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cells</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">new_value</span>

    <span class="c1"># Config the canvas size</span>
    <span class="k">def</span> <span class="nf">_resize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_canvas</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ncols</span><span class="o">*</span><span class="p">(</span><span class="n">game2dboard</span><span class="o">.</span><span class="n">Cell</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">cell_spacing</span><span class="p">)</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">cell_spacing</span><span class="p">,</span>
                            <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span><span class="o">*</span><span class="p">(</span><span class="n">game2dboard</span><span class="o">.</span><span class="n">Cell</span><span class="o">.</span><span class="n">height</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">cell_spacing</span><span class="p">)</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">cell_spacing</span><span class="p">)</span>

    <span class="c1"># Translate [row][col] to canvas coordinates</span>
    <span class="k">def</span> <span class="nf">_rc2xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">col</span><span class="o">*</span><span class="p">(</span><span class="n">game2dboard</span><span class="o">.</span><span class="n">Cell</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">cell_spacing</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">row</span><span class="o">*</span><span class="p">(</span><span class="n">game2dboard</span><span class="o">.</span><span class="n">Cell</span><span class="o">.</span><span class="n">height</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">cell_spacing</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="c1"># Translate canvas coordinates to (row, col)</span>
    <span class="k">def</span> <span class="nf">_xy2rc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="c1"># how can i optimize it ???? May be _self.canvas.find_withtag(CURRENT)</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ncols</span><span class="p">):</span>
                <span class="n">cell</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cells</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">cell</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">cell</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">game2dboard</span><span class="o">.</span><span class="n">Cell</span><span class="o">.</span><span class="n">width</span> \
                        <span class="ow">and</span> <span class="n">cell</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">cell</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">game2dboard</span><span class="o">.</span><span class="n">Cell</span><span class="o">.</span><span class="n">height</span><span class="p">:</span>
                    <span class="k">return</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="c1"># Inner classes</span>
    <span class="c1"># ---------------------------------------------------------------</span>

    <span class="c1"># A row is a list, so I can use the magic function __setitem__(board[i][j])</span>

    <span class="k">class</span> <span class="nc">_BoardRow</span><span class="p">(</span><span class="n">UserList</span><span class="p">):</span>
        <span class="c1"># Last acessed row (class member).</span>
        <span class="c1"># Yes, its not thread safe!</span>
        <span class="c1"># Maybe in the future I will use a proxy class</span>
        <span class="n">current_i</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
            <span class="n">UserList</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">length</span><span class="p">)</span>         <span class="c1"># Initialize the row</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent</span>           <span class="c1"># the board</span>

        <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">_notify_change</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">current_i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/universe.jpg" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Universe</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Board.html">This is a template for including classes</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="../../index.html">game2dboard  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, mjbrusso.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.3.
    </div>
  </body>
</html>